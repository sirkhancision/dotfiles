#!/usr/bin/env nu

export def main [...files: path] {
  if ($files | length) > 0 {
    (compile_files $files)
    print "The files finished compiling"
  } else {
    error make { msg: "missing file parameters" }
  }
}

def compile_files [files] {
  $files | each {
    |file| if ($file | str ends-with ".c") {
      ^gcc -o ($file | str replace ".c" "") $file -O2 -pedantic -pipe -Wall -Werror -lm
    } else if not ($file | path exists) {
      print $"($file) not found, ignoring..."
    } else {
      print $"($file) is not a C file, ignoring..."
    }
  }
}
